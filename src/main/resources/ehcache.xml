<?xml version="1.0" encoding="UTF-8"?>

<config xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
        xmlns='http://www.ehcache.org/v3'
        xsi:schemaLocation="http://www.ehcache.org/v3
  http://www.ehcache.org/schema/ehcache-core-3.0.xsd">

    <default-serializers>
        <serializer type="edu.utexas.arlut.ciads.scratch.xgraph.XVertex">edu.utexas.arlut.ciads.scratch.xgraph.serializer.XVertexSerializer</serializer>
        <serializer type="edu.utexas.arlut.ciads.scratch.xgraph.XEdge">edu.utexas.arlut.ciads.scratch.xgraph.serializer.XEdgeSerializer</serializer>
        <!--<serializer type="java.lang.Long">org.ehcache.jsr107.LongSerializer</serializer>-->
    </default-serializers>
    <default-copiers></default-copiers>

    <!--TODO: use system property for cache location-->
    <persistence directory="cache"/>
    <thread-pools>
        <thread-pool alias="defaultDiskPool" min-size="1" max-size="3" default="true"/>
        <thread-pool alias="defaultWriteBehindPool" min-size="1" max-size="3"/>
        <thread-pool alias="cache2Pool" min-size="1" max-size="2"/>
    </thread-pools>

    <!--<disk-store thread-pool="defaultDiskPool" />-->
    <event-dispatch thread-pool="defaultEventPool"/>
    <write-behind thread-pool="defaultWriteBehindPool"/>
    <disk-store thread-pool="defaultDiskPool"/>




    <!-- TODO: check on serializer...kryo? -->
    <!-- TODO: copy on read? -->
    <cache-template name="element-store-template">
        <key-type copier="org.ehcache.impl.copy.SerializingCopier"
                          serializer="org.ehcache.jsr107.LongSerializer">
            java.lang.Long
        </key-type>
        <expiry>
            <none/>
        </expiry>
        <resources>
            <heap unit="GB">1</heap>
            <disk unit="GB" persistent="true">50</disk>
        </resources>
        <disk-store-settings thread-pool="pool-disk" writer-concurrency="2"/>
    </cache-template>



    <cache alias="sikm">
        <!--TODO: do we want a copier?-->
        <key-type copier="org.ehcache.impl.copy.SerializingCopier">java.lang.Long</key-type>
        <value-type copier="org.ehcache.impl.copy.SerializingCopier">edu.utexas.arlut.ciads.scratch.App$Foo
            </value-type>
        <listeners dispatcher-thread-pool="cache2Pool"/>
        <resources>
            <heap unit="MB">100</heap>
            <disk unit="GB" persistent="true">100</disk>
        </resources>

        <disk-store-settings thread-pool="defaultDiskPool" writer-concurrency="2"/>
    </cache>

    <cache alias="vertices">
        <key-type copier="org.ehcache.impl.copy.SerializingCopier">java.lang.Long</key-type>
        <value-type copier="org.ehcache.impl.copy.SerializingCopier">
            edu.utexas.arlut.ciads.scratch.xgraph.XVertex
            </value-type>
        <listeners dispatcher-thread-pool="cache2Pool"/>
        <resources>
            <heap unit="MB">100</heap>
            <disk unit="GB" persistent="true">100</disk>
        </resources>

        <disk-store-settings thread-pool="defaultDiskPool" writer-concurrency="2"/>
    </cache>
    <cache alias="edges">
        <key-type copier="org.ehcache.impl.copy.SerializingCopier">java.lang.Long</key-type>
        <value-type copier="org.ehcache.impl.copy.SerializingCopier">
            edu.utexas.arlut.ciads.scratch.xgraph.XEdge
        </value-type>
        <listeners dispatcher-thread-pool="cache2Pool"/>
        <resources>
            <heap unit="MB">100</heap>
            <disk unit="GB" persistent="true">100</disk>
        </resources>

        <disk-store-settings thread-pool="defaultDiskPool" writer-concurrency="2"/>
    </cache>
</config>
